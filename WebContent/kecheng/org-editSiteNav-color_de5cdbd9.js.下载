/*! ablejs - v0.2.0 - Wednesday, December 10th, 2014, 5:53:43 PM
* http://www.ablesky.com
* Copyright (c) 2014 frontend@ablesky.com; Licensed  */
define(["module","jquery","common/global","lib/jquery/jquery.dialog","organizationIndex/component/org-common","lib/jquery/jquery.tmpl"],function(e,t,i,o,n){"use strict";var s=n.orgInfo.organizationId;e.config();var a=e.config().siteNavInfo,r=['<div class="edit-nav-outter edit-area-isShowFlag" id="J_editSiteNavColor">','<div class="edit-nav-wrapper edit-nav-color" >','<div class="enc-type">点击更改颜色</div>','<ul class="enc-list-wrap clearfix">','<li class="list">','<span class="list-color lc-bg-color" style="background-color:${bottomColor}" data-color="${bottomColor}"></span>',"<p>通用头底色</p>","</li>",'<li class="list">','<span class="list-color lc-word-color" style="background-color:${wordColor}" data-color="${wordColor}"></span>',"<p>文字颜色</p>","</li>",'<li class="list">','<span class="list-color lc-word-hover" style="background-color:${hoverwordColor}" data-color="${hoverwordColor}"></span>',"<p>文字划过</p>","</li>","</ul>","</div>",'<ul id="J_editSiteNavColorBtnAction" class="dress-btn-action editBtnAction-isShowFlag clearfix">','<li class="dress-btnsave dressBtnAction"><a href="javascript:;">保存</a></li>','<li class="dress-btnexit dressBtnAction"><a href="javascript:;">退出</a></li>','<li class="dress-default dressBtnAction"><a href="javascript:;">恢复默认</a></li>',"</ul>","</div>"].join("");t.template("editSiteNavColorHtmlTmpl",r);var l=["#J_siteNav{background-color:${bottomColor};}","#J_siteNav menu{border-color:${bottomColor};} ","#J_siteNav a.nav-link{border-color:${bottomColor};}","#J_siteNav .trigger-wrapper-hover a.menu-trigger {border-color:${bottomColor};color:${wordColor};}","#J_siteNav a.link { color: ${wordColor};}","#J_siteNav a.link:hover { color: ${hoverwordColor};}"].join("");t.template("editSiteNavCssTmpl",l);var c=function(){t("#J_editSiteNavColor")[0]?(t("#J_editSiteNavColor").show(),t("#J_editSiteNavColorBtnAction").show()):t.tmpl("editSiteNavColorHtmlTmpl",a).appendTo("#J_orgDressPart");var e=t("#J_editSiteNavColor"),i=function(){t("#J_custom_siteNavStyle").remove(),t("head").append('<style id="J_custom_siteNavStyle">'+t.tmpl("editSiteNavCssTmpl",a)[0].nodeValue+"</style>")};t(".enc-list-wrap .list",e).on({mouseover:function(){t(this).addClass("list-hover")},mouseout:function(){t(this).removeClass("list-hover")}}),t(".enc-list-wrap .list",e).each(function(){var e=t(this),o=t(".list-color",e).data("color").substring(1);e.colpick({submitText:"确定",layout:"hex",color:o,onSubmit:function(e,o,n,s){var r=t(".list-color",s);r.css("background-color","#"+o).data("color","#"+o),t(s).colpickHide(),r.hasClass("lc-bg-color")&&(a.bottomColor=r.data("color")),r.hasClass("lc-word-color")&&(a.wordColor=r.data("color")),r.hasClass("lc-word-hover")&&(a.hoverwordColor=r.data("color")),i()}})});var o=!1;t("#J_editSiteNavColorBtnAction .dress-btnsave").off("click").on("click",function(){var i={organizationId:s,bottomColor:a.bottomColor,wordColor:a.wordColor,hoverWordColor:a.hoverwordColor};o||(o=!0,t.ajax({url:"orgHead.do?action=postOrgHeadDetail",type:"POST",dataType:"json",data:i,success:function(i){i.success?(t.dialog({title:"提示",content:'<div style="text-align: center;">操作成功！</div>',width:380,timeout:1}),setTimeout(function(){e.fadeOut()},1e3)):alert(i.message)},complete:function(){setTimeout(function(){o=!1},1e3)}}))}),t("#J_editSiteNavColorBtnAction .dress-default").off("click").on("click",function(){t.ajax({url:"orgHead.do?action=resetOrgHeadDetail&organizationId="+s,type:"POST",dataType:"json",success:function(i){i.success?(t.dialog({title:"提示",content:'<div style="text-align: center;">操作成功！</div>',width:380,timeout:1}),setTimeout(function(){e.fadeOut()},1e3)):alert(i.message)}})}),t("#J_editSiteNavColorBtnAction .dress-btnexit").off("click").on("click",function(){e.fadeOut()})};return{init:c}});